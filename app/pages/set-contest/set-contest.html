<ion-navbar *navbar>
  <button menuToggle>
    <ion-icon name="menu"></ion-icon>
  </button>
  <ion-title>{{getTitle()}}</ion-title>
</ion-navbar>

<ion-content>

  <h4 text-center>
    {{client.translate('WHO_IS_SMARTER')}} - {{contestLocalCopy.content.category.title}}
  </h4>

  <div padding *ngIf="client.session.features.newContest.locked">
    <span class="feature-locked-text">{{client.translate('FEATURE_LOCKED_NEW_CONTEST', {rank : client.session.features.newContest.unlockRank}) }}</span>
    <button class="button button-full button-small button-favorite"
            (click)="buyNewContestUnlockKey(false)" [disabled]="buyInProgress">
      {{client.translate('UNLOCK_FEATURE', {formattedCost :
      client.session.features.newContest.purchaseData.formattedCost}) }}
    </button>
    <button class="button button-full button-small button-favorite"
            *ngIf="client.user.clientInfo.platform ==='facebook' && client.session.features.newContest.purchaseData.mobilePricepointId"
            (click)="buyNewContestUnlockKey(true)" [disabled]="buyInProgress">
      {{client.translate('UNLOCK_FEATURE_MOBILE',
      {
      cost : client.session.features.newContest.purchaseData.cost,
      currency : client.session.features.newContest.purchaseData.currencySymbol}) }}
    </button>
  </div>

  <form [ngFormModel]="contestForm" name="contestForm" novalidate="novalidate">

    <ion-row>
      <ion-col width-40>
        <ion-input>
          <input type="text"
                 ngControl="team0"
                 [(ngModel)]="contestLocalCopy.teams[0].name"
                 placeholder="{{client.translate('TEAM0')}}"
                 [disabled]="client.session.features.newContest.locked">
        </ion-input>
      </ion-col>
      <ion-col width-20 class="contest-or-between-teams">
        <h5 text-center>{{client.translate('OR')}}</h5>
      </ion-col>
      <ion-col width-40>
        <ion-input>
          <input type="text"
                 ngControl="team1"
                 [(ngModel)]="contestLocalCopy.teams[1].name"
                 placeholder="{{client.translate('TEAM1')}}"
                 [disabled]="client.session.features.newContest.locked">
        </ion-input>
      </ion-col>
    </ion-row>
    <ion-row>
      <ion-col width-40>
        <div text-center *ngIf="team0.dirty && team0.errors && team0.errors.required" class="invalid-input">
          {{client.translate('FIELD_REQUIRED')}}
        </div>
      </ion-col>
      <ion-col>
        <div text-center *ngIf="contestForm.dirty && contestForm.errors && contestForm.errors.matchingTeams"
             class="invalid-input">
          {{client.translate('SERVER_ERROR_TEAMS_MUST_HAVE_DIFFERENT_NAMES_MESSAGE')}}
        </div>
      </ion-col>
      <ion-col width-40>
        <div text-center *ngIf="team1.dirty && team1.errors && team1.errors.required" class="invalid-input">
          {{client.translate('FIELD_REQUIRED')}}
        </div>
      </ion-col>
    </ion-row>

    <ion-select no-lines [(ngModel)]="contestLocalCopy.endOption" okText="{{client.translate('OK')}}"
                cancelText="{{client.translate('CANCEL')}}">
      <ion-label>{{client.translate('ENDS_IN')}}</ion-label>
      <ion-option *ngFor="#endOptionKey of endOptionKeys"
                  value="{{client.settings.newContest.endOptions[endOptionKey].value}}"
                  checked="{{contestLocalCopy.endOption===client.settings.newContest.endOptions[endOptionKey].value}}">
        {{client.translate(client.settings.newContest.endOptions[endOptionKey].units, {number: client.settings.newContest.endOptions[endOptionKey].number}) }}
      </ion-option>
    </ion-select>

    <div padding *ngIf="params.data.mode==='add'">
        <span class="set-contest-label">{{client.translate('CONTEST_END')}}</span>
        <date-picker [currentDate]="contestLocalCopy.endDate" [(minDate)]="minContestEnd" [(maxDate)]="maxContestEnd" currentDateClass="calendar-button"
                     (dateSelected)="endDateSelected($event)">
        </date-picker>
    </div>

    <div padding class="set-contest-label" *ngIf="client.session.isAdmin">
      <span class="pointer" (click)="toggleAdminInfo()">{{client.translate('CONTEST_ADMIN_INFO')}} {{getArrowDirection(!showAdminInfo)}}</span>
      <div *ngIf="showAdminInfo && contestForm.valid">
        <div padding *ngIf="showStartDate">
          <span>{{client.translate('CONTEST_START')}}</span>
          <date-picker [currentDate]="contestLocalCopy.startDate" [(minDate)]="minContestStart" currentDateClass="calendar-button"
                       (dateSelected)="startDateSelected($event)">
          </date-picker>
        </div>
      </div>
    </div>

    <div padding>
      <button (click)="contestForm.valid && setContest()" block>{{client.translate('OK')}}</button>
    </div>
  </form>
</ion-content>
